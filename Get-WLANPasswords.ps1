(([regex]::match($(netsh wlan show profile), "(?<=Profile\s*:\s).+")).Value -ireplace "\s*All User Profile\s*: ","," -ireplace "\s*$","" -split "," | foreach{ $(netsh wlan show profile name=$_ key=clear) | Select-String -Pattern "SSID Name","Key Content"}) -join "," -ireplace "(SSID name\s*:\s)|(Key Content\s*:\s)","" -ireplace "(\s+(?=`"))|((?<=,)\s*)","" -split ",`"" -ireplace "`"","" |  foreach{ $curr=$_.split(",");[pscustomobject]@{"SSID" = $curr[0];"Password" = $curr[1]} } | ConvertTo-Json -Depth 2